<properties 
   pageTitle="SQL 数据库灾难恢复演练" 
   description="了解有关使用 Azure SQL 数据库执行灾难恢复演练，帮助任务关键型业务应用程序弹性应对故障和中断的指导和最佳实践。" 
   services="sql-database" 
   documentationCenter="" 
   authors="mihaelablendea" 
   manager="jeffreyg" 
   editor="monicar"/>

<tags
   ms.service="sql-database"
   ms.date="07/15/2015"
   wacn.date="09/15/2015"/>

#执行灾难恢复演练

建议定期对恢复工作流执行应用程序就绪性验证。验证应用程序的行为以及数据丢失和/或涉及到故障转移的中断所造成的影响，是一种良好的工程实践。许多行业标准在涉及到业务连续性认证方面也会提出此要求。

执行灾难恢复演练的操作包括：

- 模拟数据层中断
- 恢复 
- 验证恢复后的应用程序完整性

根据[业务连续性的设计](/documentation/articles/sql-database-business-continuity)方式，用于执行演练的工作流会有所不同。下面将会讨论在 Azure SQL 数据库 上下文中执行灾难恢复演练的最佳实践。 

##异地还原

若要防止执行灾难恢复演练时发生潜在的数据丢失，我们建议通过创建生产环境的副本在测试环境中执行演练，并使用测试环境来验证应用程序的故障转移工作流。
 
####中断模拟

- 通过删除或重命名源数据库并造成应用程序连接故障来模拟中断。这样，你便可以验证中断检测/警报功能，并度量恢复持续时间 RTO。

####恢复

- 根据[此处](/documentation/articles/sql-database-disaster-recovery)所述，在另一台服务器中执行数据库异地还原。 
- 更改应用程序配置以连接到已恢复的数据库，并根据[确认已恢复的数据库](/documentation/articles/sql-database-recovered-finalize)指南完成恢复。

####验证

- 通过验证恢复后的应用程序完整性（例如，连接字符串、登录名、基本功能测试，或标准应用程序验收过程的其他验证部分）来完成演练。

##标准异地复制

使用标准异地复制保护的数据库只能有一个不可读的辅助数据库。演练操作包括强行终止链接，此时，该数据库将不会受到保护。此外，这还有可能会发生数据丢失，因此，我们不建议客户对生产数据库执行此类测试。而是建议创建生产环境的副本，然后使用该副本来验证应用程序的故障转移工作流。

####中断模拟

- 模拟主数据库上的工作负荷。如果终止时主数据库处于活动状态，则可能会发生数据丢失，这会使得演练更接近现实。
- 删除主数据库，或者在辅助数据库端[执行强行终止](/documentation/articles/sql-database-disaster-recovery)链接。

####恢复

- 更改应用程序配置以连接到以前的只读辅助数据库，这将使得该数据库完全可访问，并且应用程序可将其用作新的主数据库。 
- 根据[确认已恢复的数据库](/documentation/articles/sql-database-recovered-finalize)指南完成恢复。

####验证

- 通过验证恢复后的应用程序完整性（例如，连接字符串、登录名、基本功能测试，或标准应用程序验收过程的其他验证部分）来完成演练。

##活动异地复制

通过使用并行目标服务器并在其中创建另一组只读辅助数据库，来执行灾难恢复演练。应使用应用程序层的测试版本来验证操作运行状况，并通过在强行终止后对该服务器运行测试来验证数据完整性。

####中断模拟

- 在主数据库与辅助测试服务器之间[创建新的活动异地复制链接](/documentation/articles/sql-database-business-continuity-design)。如果终止时主数据库处于活动状态，则可能会发生数据丢失，这会使得演练更接近现实。
- 对测试服务器上的辅助数据库[执行强行终止](/documentation/articles/sql-database-disaster-recovery)链接。

####恢复

- 在终止后，更改应用程序配置以连接到以前的只读辅助数据库，该数据库现在将可供写入。
- 根据[确认已恢复的数据库](/documentation/articles/sql-database-recovered-finalize)指南完成恢复。

####验证

- 通过验证恢复后的应用程序完整性（例如，连接字符串、登录名、基本功能测试，或标准应用程序验收过程的其他验证部分）来完成演练。

<!---HONumber=69-->