## 负载平衡器之间的差异

使用 Azure 分配网络流量有不同的选项。这些选项的工作方式彼此不同，具有不同的功能集，并支持不同的方案。这些选项每个都能单独使用，也可以组合使用。

- **Azure Load Balancer** 在传输层（OSI 网络参考堆栈中的第 4 层）工作。它可对同一 Azure 数据中心中运行的应用程序实例间的流量进行网络级分配。

- **应用程序网关**在应用程序层（OSI 网络参考堆栈中的第 7 层）工作。它充当反向代理服务，终止客户端连接，并将请求转发到后端终结点。

- **流量管理器**在 DNS 级别工作。它使用 DNS 响应将最终用户流量定向到全球分布的终结点。然后，客户端直接连接到这些终结点。

下表总结了每个服务提供的功能：

| 服务 | Azure 负载平衡器 | 应用程序网关 | 流量管理器 |
|---|---|---|---|
|技术| 传输层（第 4 层） | 应用程序层（第 7 层） | DNS 级别 |
| 支持的应用程序协议 |	任意 | HTTP 和 HTTPS | 	任何（HTTP 终结点是终结点监视所必需的） |
| 终结点 | Azure VM 和云服务角色实例 | 任何 Azure 内部 IP 地址或公共 Internet IP 地址 | Azure VM、云服务、Azure Web 应用和外部终结点 |
| 虚拟网络支持 | 可用于面向 Internet 的应用程序和内部 (Vnet) 应用程序 | 可用于面向 Internet 的应用程序和内部 (Vnet) 应用程序 |	仅支持面向 Internet 的应用程序 |
| 终结点监视 | 通过探测支持 | 通过探测支持 | 通过 HTTP/HTTPS GET 支持 | 

Azure Load Balancer 和应用程序网关都将网络流量路由到终结点，但它们具有处理流量的不同使用方案。下表有助于了解这两种负载平衡器之间的区别：

| 类型 | Azure 负载平衡器 | 应用程序网关 |
|---|---|---|
| 协议 | UDP/TCP | HTTP/HTTPS |
| IP 保留 | 支持 | 不支持 | 
| 负载平衡模式 | 5 元组（源 IP、源端口、目标 IP、目标端口、协议类型） | 轮循机制<br>基于 URL 的路由 | 
| 负载平衡模式（源 IP/粘性会话） | 2 元组（源 IP 和目标 IP）、3 元组（源 IP、目标 IP 和端口）。可以根据虚拟机数增加或减少 | 基于 Cookie 的相关性<br>基于 URL 的路由 |
| 运行状况探测 | 默认值：探测间隔 - 15 秒。退出循环：2 次连续失败。支持用户定义的探测 | 空闲探测间隔 30 秒。在 5 次连续实时通信失败或空闲模式下单次探测失败后取出。支持用户定义的探测 | 
| SSL 卸载 | 不支持 | 支持 | 
  

<!---HONumber=Mooncake_0926_2016-->
